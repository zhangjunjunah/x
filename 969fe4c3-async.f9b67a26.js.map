{"version":3,"sources":[".dumi/hooks/useDark.tsx",".dumi/theme/SiteThemeProvider.tsx",".dumi/theme/common/PeterCat.tsx",".dumi/theme/layouts/GlobalLayout.tsx"],"sourcesContent":["import React from 'react';\n\nexport const DarkContext = React.createContext(false);\n\nexport default function useDark() {\n  return React.useContext(DarkContext);\n}\n","import { ConfigProvider, theme as antdTheme } from 'antd';\nimport type { ThemeConfig } from 'antd';\nimport type { ThemeProviderProps } from 'antd-style';\nimport { ThemeProvider } from 'antd-style';\nimport React, { useContext } from 'react';\n\ninterface NewToken {\n  bannerHeight: number;\n  headerHeight: number;\n  menuItemBorder: number;\n  mobileMaxWidth: number;\n  siteMarkdownCodeBg: string;\n  antCls: string;\n  iconCls: string;\n  marginFarXS: number;\n  marginFarSM: number;\n  marginFar: number;\n  codeFamily: string;\n  contentMarginTop: number;\n  anchorTop: number;\n  indexRadius: number;\n  pcMaxWidth: number;\n  pcContainerMargin: number;\n}\n\n// 通过给 antd-style 扩展 CustomToken 对象类型定义，可以为 useTheme 中增加相应的 token 对象\ndeclare module 'antd-style' {\n  export interface CustomToken extends NewToken {}\n}\n\nconst headerHeight = 80;\nconst bannerHeight = 38;\nconst indexRadius = 24;\nconst pcMaxWidth = 1560;\n\nconst SiteThemeProvider: React.FC<ThemeProviderProps<any>> = ({ children, theme, ...rest }) => {\n  const { getPrefixCls, iconPrefixCls } = useContext(ConfigProvider.ConfigContext);\n  const rootPrefixCls = getPrefixCls();\n  const { token } = antdTheme.useToken();\n  React.useEffect(() => {\n    // 需要注意与 components/config-provider/demo/holderRender.tsx 配置冲突\n    ConfigProvider.config({ theme: theme as ThemeConfig });\n  }, [theme]);\n\n  return (\n    <ThemeProvider<NewToken>\n      {...rest}\n      theme={theme}\n      customToken={{\n        headerHeight,\n        bannerHeight,\n        indexRadius,\n        pcMaxWidth,\n        pcContainerMargin: 100,\n        menuItemBorder: 2,\n        mobileMaxWidth: 767.99,\n        siteMarkdownCodeBg: token.colorFillTertiary,\n        antCls: `.${rootPrefixCls}`,\n        iconCls: `.${iconPrefixCls}`,\n        /** 56 */\n        marginFarXS: (token.marginXXL / 6) * 7,\n        /** 80 */\n        marginFarSM: (token.marginXXL / 3) * 5,\n        /** 96 */\n        marginFar: token.marginXXL * 2,\n        codeFamily: `'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace`,\n        contentMarginTop: 40,\n        anchorTop: headerHeight + token.margin,\n      }}\n    >\n      {children}\n    </ThemeProvider>\n  );\n};\n\nexport default SiteThemeProvider;\n","import { Assistant } from '@petercatai/assistant';\nimport React from 'react';\n\nimport '@petercatai/assistant/style';\n\nconst PeterCat: React.FC = () => {\n  return (\n    <Assistant\n      showBubble={true}\n      isVisible={false}\n      bottom={48}\n      token=\"e3092c32-9ed9-44c2-ad0c-7251e382c2df\"\n      apiDomain=\"https://api.petercat.ai\"\n    />\n  );\n};\n\nexport default PeterCat;\n","import {\n  NaNLinter,\n  StyleProvider,\n  createCache,\n  extractStyle,\n  legacyNotSelectorLinter,\n  parentSelectorLinter,\n} from '@ant-design/cssinjs';\nimport { getSandpackCssText } from '@codesandbox/sandpack-react';\nimport { App, theme as antdTheme } from 'antd';\nimport { createSearchParams, useOutlet, useSearchParams, useServerInsertedHTML } from 'dumi';\nimport React, { Suspense, useCallback, useEffect } from 'react';\n\nimport type { MappingAlgorithm } from 'antd';\nimport type { DirectionType, ThemeConfig } from 'antd/es/config-provider';\n\nimport { DarkContext } from '../../hooks/useDark';\nimport useLayoutState from '../../hooks/useLayoutState';\nimport useLocation from '../../hooks/useLocation';\nimport SiteThemeProvider from '../SiteThemeProvider';\nimport PeterCat from '../common/PeterCat';\nimport type { ThemeName } from '../common/ThemeSwitch';\nimport type { SiteContextProps } from '../slots/SiteContext';\nimport SiteContext from '../slots/SiteContext';\n\nimport '@ant-design/v5-patch-for-react-19';\n\nconst ThemeSwitch = React.lazy(() => import('../common/ThemeSwitch'));\n\ntype Entries<T> = { [K in keyof T]: [K, T[K]] }[keyof T][];\ntype SiteState = Partial<Omit<SiteContextProps, 'updateSiteContext'>>;\n\nconst RESPONSIVE_MOBILE = 768;\nexport const ANT_DESIGN_NOT_SHOW_BANNER = 'ANT_DESIGN_NOT_SHOW_BANNER';\n\n// const styleCache = createCache();\n// if (typeof global !== 'undefined') {\n//   (global as any).styleCache = styleCache;\n// }\n\nconst getAlgorithm = (themes: ThemeName[] = []) =>\n  themes\n    .map((theme) => {\n      if (theme === 'dark') {\n        return antdTheme.darkAlgorithm;\n      }\n      if (theme === 'compact') {\n        return antdTheme.compactAlgorithm;\n      }\n      return null as unknown as MappingAlgorithm;\n    })\n    .filter(Boolean);\n\nconst GlobalLayout: React.FC = () => {\n  const outlet = useOutlet();\n  const { pathname } = useLocation();\n  const { token } = antdTheme.useToken();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [{ theme = [], direction, isMobile }, setSiteState] = useLayoutState<SiteState>({\n    isMobile: false,\n    direction: 'ltr',\n    theme: [],\n  });\n  const isIndexPage = React.useMemo(\n    () => pathname === '' || pathname.startsWith('/index'),\n    [pathname],\n  );\n\n  const updateSiteConfig = useCallback(\n    (props: SiteState) => {\n      setSiteState((prev) => ({ ...prev, ...props }));\n\n      // updating `searchParams` will clear the hash\n      const oldSearchStr = searchParams.toString();\n\n      let nextSearchParams: URLSearchParams = searchParams;\n      (Object.entries(props) as Entries<SiteContextProps>).forEach(([key, value]) => {\n        if (key === 'direction') {\n          if (value === 'rtl') {\n            nextSearchParams.set('direction', 'rtl');\n          } else {\n            nextSearchParams.delete('direction');\n          }\n        }\n        if (key === 'theme') {\n          nextSearchParams = createSearchParams({\n            ...nextSearchParams,\n            theme: value.filter((t) => t !== 'light'),\n          });\n\n          document\n            .querySelector('html')\n            ?.setAttribute('data-prefers-color', value.includes('dark') ? 'dark' : 'light');\n        }\n      });\n\n      if (nextSearchParams.toString() !== oldSearchStr) {\n        setSearchParams(nextSearchParams);\n      }\n    },\n    [searchParams, setSearchParams],\n  );\n\n  const updateMobileMode = () => {\n    updateSiteConfig({ isMobile: window.innerWidth < RESPONSIVE_MOBILE });\n  };\n\n  useEffect(() => {\n    const metaThemeColor = document.querySelector('meta[name=\"theme-color\"]');\n\n    if (metaThemeColor) {\n      metaThemeColor.setAttribute('content', isIndexPage ? '#0c0e10cc' : token.colorBgContainer);\n    }\n  }, [theme.length, isIndexPage]);\n\n  useEffect(() => {\n    const _theme = searchParams.getAll('theme') as ThemeName[];\n    const _direction = searchParams.get('direction') as DirectionType;\n\n    setSiteState({\n      theme: _theme,\n      direction: _direction === 'rtl' ? 'rtl' : 'ltr',\n    });\n    document.documentElement.setAttribute(\n      'data-prefers-color',\n      _theme.includes('dark') ? 'dark' : 'light',\n    );\n    // Handle isMobile\n    updateMobileMode();\n\n    window.addEventListener('resize', updateMobileMode);\n    return () => {\n      window.removeEventListener('resize', updateMobileMode);\n    };\n  }, []);\n\n  const siteContextValue = React.useMemo<SiteContextProps>(\n    () => ({\n      direction,\n      updateSiteConfig,\n      theme: theme!,\n      isMobile: isMobile!,\n    }),\n    [isMobile, direction, updateSiteConfig, theme],\n  );\n\n  const themeConfig = React.useMemo<ThemeConfig>(\n    () => ({\n      // index page should always use dark theme\n      algorithm: isIndexPage ? getAlgorithm(['dark']) : getAlgorithm(theme),\n      token: { motion: !theme.includes('motion-off') },\n      cssVar: true,\n      hashed: false,\n    }),\n    [theme, pathname],\n  );\n\n  const [styleCache] = React.useState(() => createCache());\n\n  useServerInsertedHTML(() => {\n    const styleText = extractStyle(styleCache, {\n      plain: true,\n      types: 'style',\n    });\n    // biome-ignore lint/security/noDangerouslySetInnerHtml: only used in .dumi\n    return <style data-type=\"antd-cssinjs\" dangerouslySetInnerHTML={{ __html: styleText }} />;\n  });\n\n  useServerInsertedHTML(() => {\n    const styleText = extractStyle(styleCache, {\n      plain: true,\n      types: ['cssVar', 'token'],\n    });\n    return (\n      <style\n        data-type=\"antd-css-var\"\n        data-rc-order=\"prepend\"\n        data-rc-priority=\"-9999\"\n        // biome-ignore lint/security/noDangerouslySetInnerHtml: only used in .dumi\n        dangerouslySetInnerHTML={{ __html: styleText }}\n      />\n    );\n  });\n\n  useServerInsertedHTML(() => (\n    <style\n      data-sandpack=\"true\"\n      id=\"sandpack\"\n      // biome-ignore lint/security/noDangerouslySetInnerHtml: only used in .dumi\n      dangerouslySetInnerHTML={{ __html: getSandpackCssText() }}\n    />\n  ));\n\n  const demoPage = pathname.startsWith('/~demos');\n\n  // ============================ Render ============================\n  let content: React.ReactNode = outlet;\n\n  // Demo page should not contain App component\n  if (!demoPage) {\n    content = (\n      <App>\n        {outlet}\n        <Suspense>\n          <ThemeSwitch\n            value={theme}\n            onChange={(nextTheme) => updateSiteConfig({ theme: nextTheme })}\n          />\n          <PeterCat />\n        </Suspense>\n      </App>\n    );\n  }\n\n  return (\n    <DarkContext.Provider value={theme.includes('dark')}>\n      <StyleProvider\n        cache={styleCache}\n        linters={[legacyNotSelectorLinter, parentSelectorLinter, NaNLinter]}\n      >\n        <SiteContext.Provider value={siteContextValue}>\n          <SiteThemeProvider theme={themeConfig}>{content}</SiteThemeProvider>\n        </SiteContext.Provider>\n      </StyleProvider>\n    </DarkContext.Provider>\n  );\n};\n\nexport default GlobalLayout;\n"],"names":[],"mappings":"+PAEa,mDAAA,MAAN,IAAM,EAAc,kBAFT,oBAEc,CAAC,aAAa,CAAC,CAAA,kFCyE/C,+CAAA,8CA3EmD,gBAGrB,oBACI,aAuElC,EAxC6D,CAAC,CAAE,SAAA,CAAQ,CAAE,MAAA,CAAK,CAAE,GAAG,EAAM,IACxF,GAAM,CAAE,aAAA,CAAY,CAAE,cAAA,CAAa,CAAE,CAAG,GAAA,YAAU,EAAC,gBAAc,CAAC,aAAa,EACzE,EAAgB,IAChB,CAAE,MAAA,CAAK,CAAE,CAAG,OAAS,CAAC,QAAQ,GAMpC,OALA,SAAK,CAAC,SAAS,CAAC,KAEd,gBAAc,CAAC,MAAM,CAAC,CAAE,MAAO,CAAqB,GACtD,EAAG,CAAC,EAAM,EAGR,UAAC,eAAa,EACX,GAAG,CAAI,CACR,MAAO,EACP,YAAa,CACX,aAnBa,GAoBb,aAnBa,GAoBb,YAnBY,GAoBZ,WAnBW,KAoBX,kBAAmB,IACnB,eAAgB,EAChB,eAAgB,OAChB,mBAAoB,EAAM,iBAAiB,CAC3C,OAAQ,CAAC,CAAC,EAAE,EAAc,CAAC,CAC3B,QAAS,CAAC,CAAC,EAAE,EAAc,CAAC,CAE5B,YAAa,AAAC,EAAM,SAAS,CAAG,EAAK,EAErC,YAAa,AAAC,EAAM,SAAS,CAAG,EAAK,EAErC,UAAW,AAAkB,EAAlB,EAAM,SAAS,CAC1B,WAAY,2EACZ,iBAAkB,GAClB,UAAW,AArCE,GAqCa,EAAM,MAAM,AACxC,WAEC,IAGP,iFCxDA,+CAAA,8BAjB0B,YAiB1B,EAZ2B,IAEvB,UAAC,WAAS,EACR,WAAY,CAAA,EACZ,UAAW,CAAA,EACX,OAAQ,GACR,MAAM,uCACN,UAAU,gICqBH,0BAA0B,mBAA1B,IAmMb,OAA4B,mBAA5B,8DA7NO,gBAC4B,gBACK,gBAC8C,oBAC9B,iBAK5B,oBACD,qBACH,qBACM,qBACT,qBAGG,eAEjB,YAEP,IAAM,EAAc,SAAK,CAAC,IAAI,CAAC,IAAM,iHAMxB,EAA6B,6BAOpC,EAAe,CAAC,EAAsB,EAAE,GAC5C,EACG,GAAG,CAAC,AAAC,GACJ,AAAI,AAAU,SAAV,EACK,OAAS,CAAC,aAAa,CAE5B,AAAU,YAAV,EACK,OAAS,CAAC,gBAAgB,CAE5B,MAER,MAAM,CAAC,aAiLZ,EA/K+B,KAC7B,IAAM,EAAS,GAAA,WAAS,IAClB,CAAE,SAAA,CAAQ,CAAE,CAAG,GAAA,SAAW,IAC1B,CAAE,MAAA,CAAK,CAAE,CAAG,OAAS,CAAC,QAAQ,GAC9B,CAAC,EAAc,EAAgB,CAAG,GAAA,iBAAe,IACjD,CAAC,CAAE,MAAA,EAAQ,EAAE,CAAE,UAAA,CAAS,CAAE,SAAA,CAAQ,CAAE,CAAE,EAAa,CAAG,GAAA,SAAc,EAAY,CACpF,SAAU,CAAA,EACV,UAAW,MACX,MAAO,EAAE,AACX,GACM,EAAc,SAAK,CAAC,OAAO,CAC/B,IAAM,AAAa,KAAb,GAAmB,EAAS,UAAU,CAAC,UAC7C,CAAC,EAAS,EAGN,EAAmB,GAAA,aAAW,EAClC,AAAC,IACC,EAAa,AAAC,GAAU,CAAA,CAAE,GAAG,CAAI,CAAE,GAAG,CAAK,AAAC,CAAA,GAG5C,IAAM,EAAe,EAAa,QAAQ,GAEtC,EAAoC,EACxC,AAAC,OAAO,OAAO,CAAC,GAAqC,OAAO,CAAC,CAAC,CAAC,EAAK,EAAM,IAQxE,GAPY,cAAR,IACE,AAAU,QAAV,EACF,EAAiB,GAAG,CAAC,YAAa,OAElC,EAAiB,MAAM,CAAC,cAGxB,AAAQ,UAAR,EAAiB,KAMnB,EALA,EAAmB,GAAA,oBAAkB,EAAC,CACpC,GAAG,CAAgB,CACnB,MAAO,EAAM,MAAM,CAAC,AAAC,GAAM,AAAM,UAAN,EAC7B,WAEA,EAAA,SACG,aAAa,CAAC,mBADjB,GAAA,EAEI,YAAY,CAAC,qBAAsB,EAAM,QAAQ,CAAC,QAAU,OAAS,SAC3E,CACF,GAEI,EAAiB,QAAQ,KAAO,GAClC,EAAgB,GAEpB,EACA,CAAC,EAAc,EAAgB,EAG3B,EAAmB,KACvB,EAAiB,CAAE,SAAU,OAAO,UAAU,CAxExB,GAwE6C,GACrE,EAEA,GAAA,WAAS,EAAC,KACR,IAAM,EAAiB,SAAS,aAAa,CAAC,4BAE1C,GACF,EAAe,YAAY,CAAC,UAAW,EAAc,YAAc,EAAM,gBAAgB,EAE7F,EAAG,CAAC,EAAM,MAAM,CAAE,EAAY,EAE9B,GAAA,WAAS,EAAC,KACR,IAAM,EAAS,EAAa,MAAM,CAAC,SAenC,OAZA,EAAa,CACX,MAAO,EACP,UAAW,AAAe,QAJT,EAAa,GAAG,CAAC,aAIA,MAAQ,KAC5C,GACA,SAAS,eAAe,CAAC,YAAY,CACnC,qBACA,EAAO,QAAQ,CAAC,QAAU,OAAS,SAGrC,IAEA,OAAO,gBAAgB,CAAC,SAAU,GAC3B,KACL,OAAO,mBAAmB,CAAC,SAAU,GACvC,EACF,EAAG,EAAE,EAEL,IAAM,EAAmB,SAAK,CAAC,OAAO,CACpC,IAAO,CAAA,CACL,UAAA,EACA,iBAAA,EACA,MAAO,EACP,SAAU,CACZ,CAAA,EACA,CAAC,EAAU,EAAW,EAAkB,EAAM,EAG1C,EAAc,SAAK,CAAC,OAAO,CAC/B,IAAO,CAAA,CAEL,UAAW,EAAc,EAAa,CAAC,OAAO,EAAI,EAAa,GAC/D,MAAO,CAAE,OAAQ,CAAC,EAAM,QAAQ,CAAC,aAAc,EAC/C,OAAQ,CAAA,EACR,OAAQ,CAAA,CACV,CAAA,EACA,CAAC,EAAO,EAAS,EAGb,CAAC,EAAW,CAAG,SAAK,CAAC,QAAQ,CAAC,IAAM,GAAA,aAAW,KAErD,GAAA,uBAAqB,EAAC,KACpB,IAAM,EAAY,GAAA,cAAY,EAAC,EAAY,CACzC,MAAO,CAAA,EACP,MAAO,OACT,GAEA,MAAO,UAAC,SAAM,YAAU,eAAe,wBAAyB,CAAE,OAAQ,CAAU,IACtF,GAEA,GAAA,uBAAqB,EAAC,KACpB,IAAM,EAAY,GAAA,cAAY,EAAC,EAAY,CACzC,MAAO,CAAA,EACP,MAAO,CAAC,SAAU,QAAQ,AAC5B,GACA,MACE,UAAC,SACC,YAAU,eACV,gBAAc,UACd,mBAAiB,QAEjB,wBAAyB,CAAE,OAAQ,CAAU,IAGnD,GAEA,GAAA,uBAAqB,EAAC,IACpB,UAAC,SACC,gBAAc,OACd,GAAG,WAEH,wBAAyB,CAAE,OAAQ,GAAA,oBAAkB,GAAG,KAI5D,IAAM,EAAW,EAAS,UAAU,CAAC,WAGjC,EAA2B,EAkB/B,OAfK,GACH,CAAA,EACE,WAAC,KAAG,YACD,EACD,WAAC,UAAQ,YACP,UAAC,GACC,MAAO,EACP,SAAU,AAAC,GAAc,EAAiB,CAAE,MAAO,CAAU,KAE/D,UAAC,SAAQ,UAGf,EAIA,UAAC,aAAW,CAAC,QAAQ,EAAC,MAAO,EAAM,QAAQ,CAAC,iBAC1C,UAAC,eAAa,EACZ,MAAO,EACP,QAAS,CAAC,yBAAuB,CAAE,sBAAoB,CAAE,WAAS,CAAC,UAEnE,UAAC,SAAW,CAAC,QAAQ,EAAC,MAAO,WAC3B,UAAC,SAAiB,EAAC,MAAO,WAAc,UAKlD"}